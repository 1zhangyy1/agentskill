{
  "id": "550fec269653244d",
  "slug": "fredrikaverpil-dotfiles",
  "name": "Dotfiles",
  "description": "",
  "author": "fredrikaverpil",
  "authorAvatar": "https://avatars.githubusercontent.com/u/994357?v=4",
  "repoUrl": "https://github.com/fredrikaverpil/dotfiles",
  "repoFullName": "fredrikaverpil/dotfiles",
  "stars": 187,
  "forks": 5,
  "category": "other",
  "categories": [
    "other"
  ],
  "tags": [
    "bash",
    "dotbot",
    "dotfiles",
    "zsh"
  ],
  "tier": 1,
  "status": "active",
  "createdAt": "2016-04-08T16:19:25Z",
  "updatedAt": "2025-12-09T07:07:26Z",
  "lastCommitAt": "2025-12-11T09:23:41Z",
  "source": "github-search",
  "collectedAt": "2025-12-12T03:42:53.905Z",
  "authorUrl": "https://github.com/fredrikaverpil",
  "license": "MIT",
  "readme": "# dotfiles ğŸ©\n\n![screenshot](https://github.com/user-attachments/assets/ef833ca0-3d39-4a7c-94af-0f76afb96e6b)\n\nPersonal dotfiles using [Nix](https://nixos.org) for reproducible system/package\nmanagement and [GNU Stow](https://www.gnu.org/software/stow/) for dotfile\nsymlinking.\n\n## Quick start\n\n<details>\n<summary>Initial installation</summary>\n\n> [!IMPORTANT]\n>\n> Make sure your terminal has full disk access on macOS before installing.\n\n```sh\n# Clone repo\ngit clone https://github.com/fredrikaverpil/dotfiles.git ~/.dotfiles\ncd ~/.dotfiles\n\n# Install Nix (Determinate Systems installer - enables flakes by default, better uninstall,\n# survives macOS updates, consistent installation across Linux/macOS)\n# Choose \"Determinate Nix\" when prompted (performance optimized, better error messages)\n# Learn more: https://determinate.systems/nix\n# IMPORTANT: choose \"no\" during install, so to install upstream Nix.\ncurl --proto '=https' --tlsv1.2 -sSf -L https://install.determinate.systems/nix | sh -s -- install\n\n# Set hostname to match a configuration in nix/hosts/\n# macOS: sudo scutil --set HostName <hostname>\n# Linux: sudo hostnamectl set-hostname <hostname>\n\n# Apply configuration\n# Linux (NixOS):\nsudo nixos-rebuild switch --flake ~/.dotfiles#$(hostname)\n\n# macOS (first time only):\nsudo nix --extra-experimental-features \"nix-command flakes\" run nix-darwin -- switch --flake ~/.dotfiles#$(hostname)\n\n# After first-time setup, use the rebuild script:\n./rebuild.sh\n```\n\n</details>\n\n```sh\n# Rebuild system + packages + dotfiles\n./rebuild.sh\n\n# Update flake inputs (nixpkgs, home-manager, etc.) then rebuild + dotfiles\n./rebuild.sh --update\n\n# Dotfiles only (no Nix rebuild)\n./rebuild.sh --stow\n```\n\n<details>\n<summary>Troubleshooting</summary>\n\n### Update stable vs unstable\n\n```sh\n# Update all unstable/Darwin-related inputs (dev machines)\nnix flake lock \\\n  --update-input nixpkgs-unstable \\\n  --update-input home-manager-unstable \\\n  --update-input nix-darwin \\\n  --update-input dotfiles\n\n# Update all stable/Linux-related inputs (prod servers)\nnix flake lock \\\n  --update-input nixpkgs \\\n  --update-input home-manager \\\n  --update-input nixos-raspberrypi \\\n  --update-input disko \\\n  --update-input dotfiles\n```\n\n### macOS permissions\n\nIf you get errors about `com.apple.universalaccess` or system settings during\nnix-darwin activation:\n\n1. **Grant Full Disk Access to your terminal:**\n   - Open System Settings > Privacy & Security > Full Disk Access\n   - Click + and add your terminal app (e.g.,\n     `/Applications/Utilities/Terminal.app`)\n   - Enable the checkbox for your terminal\n\n### SSL certificate issues (when choosing upstream Nix)\n\nIf you get SSL certificate errors after switching from Determinate to upstream\nNix:\n\n```sh\n# Fix broken certificate symlink\nsudo rm /etc/ssl/certs/ca-certificates.crt\nsudo ln -s /etc/ssl/cert.pem /etc/ssl/certs/ca-certificates.crt\n\n# Clean up leftover Determinate configuration\nsudo cp /etc/nix/nix.conf /etc/nix/nix.conf.backup\nsudo tee /etc/nix/nix.conf << 'EOF'\nextra-experimental-features = nix-command flakes\nmax-jobs = auto\nssl-cert-file = /etc/ssl/cert.pem\nEOF\n```\n\n### General troubleshooting\n\n```sh\n# Check configuration\nnix flake check ~/.dotfiles\n\n# Verbose rebuild\nsudo nixos-rebuild switch --flake ~/.dotfiles --show-trace  # Linux\ndarwin-rebuild switch --flake ~/.dotfiles --show-trace      # macOS\n\n# Clean cache\nnix-collect-garbage -d\n\n# Rollback\nsudo nixos-rebuild --rollback  # Linux\ndarwin-rebuild --rollback      # macOS\n```\n\n</details>\n\n## Nix management responsibilities\n\n<details>\n<summary>Repo structure</summary>\n\n```txt\nâ”œâ”€â”€ nix/                             # Nix configurations\nâ”‚   â”œâ”€â”€ hosts/                       # Host-specific configurations\nâ”‚   â”‚   â””â”€â”€ $host/                   # Individual host directory\nâ”‚   â”‚       â”œâ”€â”€ configuration.nix    # System settings\nâ”‚   â”‚       â”œâ”€â”€ hardware.nix         # Hardware config (optional, for NixOS)\nâ”‚   â”‚       â””â”€â”€ users/\nâ”‚   â”‚           â””â”€â”€ $username.nix    # User config\nâ”‚   â”œâ”€â”€ lib/                         # Helper functions\nâ”‚   â”‚   â”œâ”€â”€ default.nix              # Library entry point\nâ”‚   â”‚   â”œâ”€â”€ systems.nix              # System configuration helpers\nâ”‚   â”‚   â””â”€â”€ users.nix                # User configuration helpers\nâ”‚   â””â”€â”€ shared/                      # Shared configurations\nâ”‚       â”œâ”€â”€ home/\nâ”‚       â”‚   â”œâ”€â”€ common.nix           # Cross-platform user packages\nâ”‚       â”‚   â”œâ”€â”€ darwin.nix           # macOS user config\nâ”‚       â”‚   â””â”€â”€ linux.nix            # Linux user config\nâ”‚       â”œâ”€â”€ overlays/\nâ”‚       â”‚   â”œâ”€â”€ default.nix          # Overlay entry point\nâ”‚       â”‚   â””â”€â”€ neovim.nix           # Neovim overlay\nâ”‚       â””â”€â”€ system/\nâ”‚           â”œâ”€â”€ common.nix           # Cross-platform system packages\nâ”‚           â”œâ”€â”€ darwin.nix           # macOS system config + Homebrew\nâ”‚           â””â”€â”€ linux.nix            # Linux system config\nâ”œâ”€â”€ nvim-fredrik/                    # Neovim configuration\nâ”œâ”€â”€ shell/                           # Shell configuration\nâ”‚   â”œâ”€â”€ bin/                         # Custom shell scripts\nâ”‚   â”œâ”€â”€ aliases.sh                   # Shell aliases\nâ”‚   â”œâ”€â”€ exports.sh                   # Environment variables\nâ”‚   â””â”€â”€ sourcing.sh                  # Shell sourcing logic\nâ”œâ”€â”€ stow/                            # GNU Stow dotfiles\nâ”œâ”€â”€ extras/                          # One-off platform-specific extras and legacy configs\nâ”œâ”€â”€ flake.nix                        # Nix flake configuration\nâ””â”€â”€ rebuild.sh                       # Main rebuild script\n```\n\n</details>\n\n### Components\n\n| Component          | Tool             | Scope       | Configuration Location             |\n| ------------------ | ---------------- | ----------- | ---------------------------------- |\n| User dotfiles      | GNU Stow         | Per-user    | `stow/`                            |\n| User packages      | home-manager     | Per-user    | `nix/shared/home/`                 |\n| User preferences   | home-manager     | Per-user    | `nix/shared/home/` + host-specific |\n| Host configuration | nix-darwin/NixOS | System-wide | `nix/hosts/*/configuration.nix`    |\n| System packages    | nix-darwin/NixOS | System-wide | `nix/shared/system/`               |\n| System settings    | nix-darwin/NixOS | System-wide | `nix/shared/system/`               |\n| Homebrew packages  | nix-darwin       | System-wide | `nix/shared/system/darwin.nix`     |\n| Package overlays   | Nix              | System-wide | `nix/shared/overlays/`             |\n\n- NixOS configuration options:\n  [stable](https://nixos.org/manual/nixos/stable/options) |\n  [unstable](https://nixos.org/manual/nixos/unstable/options)\n- [Home manager configuration options](https://nix-community.github.io/home-manager/options.xhtml)\n- [nix-darwin configuration options](https://nix-darwin.github.io/nix-darwin/manual/index.html)\n\n### Packages\n\n| Package Type       | macOS System | macOS User | Linux System | Linux User |\n| ------------------ | ------------ | ---------- | ------------ | ---------- |\n| CLI tools          | Nix          | Nix        | Nix          | Nix        |\n| GUI apps           | Homebrew     | Homebrew   | Nix          | Nix        |\n| Mac App Store apps | Homebrew     | Homebrew   | -            | -          |\n| Fonts              | Nix          | Nix        | Nix          | Nix        |\n\n### Package sources\n\nThe intent here is to follow \"unstable\" sources on development machines, but\nremain \"stable\" on e.g. production servers.\n\n| Component    | macOS Source           | Linux Source    | Rationale                    |\n| ------------ | ---------------------- | --------------- | ---------------------------- |\n| nixpkgs      | nixpkgs-unstable       | nixpkgs (25.05) | macOS: latest, Linux: stable |\n| home-manager | home-manager-unstable  | release-25.05   | macOS: latest, Linux: stable |\n| nix-darwin   | master (uses unstable) | -               | Always latest features       |\n\nRegistry shortcuts:\n\n```sh\n# Stable packages\nnix shell n#neovim\n\n# Unstable packages\nnix shell u#nodejs_22\n```\n\n### Dotfiles\n\nDotfiles are managed with GNU Stow, not Nix:\n\n- Edit files in `stow/` directory\n- Changes are immediately active (no rebuild needed)\n- Nix runs stow commands during home-manager activation\n\n```bash\n# Manual stow (if needed)\ncd ~/.dotfiles/stow\nstow --target=\"$HOME\" --restow shared \"$(uname -s)\"\n```\n\n## Other READMEs and references\n\n### Host-specific documentation\n\n- [rpi5-homelab](nix/hosts/rpi5-homelab/README.md) - requires custom\n  installation procedure\n\n### Non-Nix legacy docs\n\n- [macOS](extras/darwin/README.md)\n- [Windows 11 + WSL](extras/windows/README.md)\n\n### Neovim âŒ¨ï¸\n\n- [nvim-fredrik](nvim-fredrik/README.md)\n\n### Git ğŸ™\n\n- [Configure git](extras/README_GIT.md)\n\n### Project config/tooling ğŸ§¢\n\n- [Configure projects](extras/README_PROJECT.md)\n\n### Fonts ğŸ’¯\n\n- [Berkeley Mono](https://berkeleygraphics.com/typefaces/berkeley-mono)\n- [Maple Mono](https://github.com/subframe7536/maple-font)\n- [Noto Color Emoji](https://fonts.google.com/noto/specimen/Noto+Color+Emoji)\n- [Symbols Nerd Font Mono](https://github.com/ryanoasis/nerd-fonts)\n",
  "installCommand": "git clone https://github.com/fredrikaverpil/dotfiles ~/.claude/skills/fredrikaverpil-dotfiles",
  "defaultBranch": "main",
  "hasMarketplaceJson": false,
  "skillPath": "README.md"
}