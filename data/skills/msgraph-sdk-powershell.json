{
  "id": "ef96439d12c16871",
  "slug": "msgraph-sdk-powershell",
  "name": "Msgraph Sdk Powershell",
  "description": "Powershell SDK for Microsoft Graph",
  "author": "microsoftgraph",
  "authorAvatar": "https://avatars.githubusercontent.com/u/17304259?v=4",
  "repoUrl": "https://github.com/microsoftgraph/msgraph-sdk-powershell",
  "repoFullName": "microsoftgraph/msgraph-sdk-powershell",
  "stars": 813,
  "forks": 213,
  "category": "other",
  "categories": [
    "other"
  ],
  "tags": [
    "cmdlets",
    "devxeng",
    "graph",
    "microsoft",
    "powershell",
    "powershell-modules",
    "powershell-sdk"
  ],
  "tier": 1,
  "status": "active",
  "createdAt": "2019-03-15T08:52:40Z",
  "updatedAt": "2025-12-14T04:52:46Z",
  "lastCommitAt": "2025-12-12T20:25:23Z",
  "source": "github-search",
  "collectedAt": "2025-12-15T03:55:23.301Z",
  "authorUrl": "https://github.com/microsoftgraph",
  "license": "NOASSERTION",
  "readme": "<h1 align=\"center\">\n    <img alt=\"Microsoft Graph PowerShell\" src=\"./docs/images/graph_color256.png\" height=\"78\" />\n  <br>Microsoft Graph PowerShell<br>\n</h1>\n\n<h4 align=\"center\">\n  Consume <a href=\"https://graph.microsoft.com\">Microsoft Graph</a> resources directly from your PowerShell scripts\n</h4>\n\n<h3 align=\"center\"><a href=\"https://learn.microsoft.com/graph/overview\">API Documentation</a> | <a href=\"https://learn.microsoft.com/powershell/microsoftgraph/overview\">SDK Documentation</a></h3>\n\n<p align=\"center\">\nThe Microsoft Graph PowerShell SDK is made up of a set of modules that enable you to interact with the Microsoft Graph API using PowerShell commands. The modules consist of commands that act as wrappers for the API, allowing you to access all the features and functionality of the API through PowerShell.\n</p>\n\n<p align=\"center\">\n  <a href=\"#modules\">Modules</a> |\n  <a href=\"#getting-started\">Getting Started</a> |\n  <a href=\"#api-version\">API Version</a> |\n  <a href=\"#notes\">Notes</a> |\n  <a href=\"#troubleshooting\">Troubleshooting</a> |\n  <a href=\"#known-issues\">Known Issues</a> |\n  <a href=\"#feedback\">Feedback</a> |\n  <a href=\"#license\">License</a>\n</p>\n\n## Modules\n\nThe table below contains links to our latest and preview versions of the Microsoft Graph module. The meta modules will install all the service modules as their dependencies.\n| Module                                  | Latest                       | Preview                        |\n| --------------------------------------- | ---------------------------- | ------------------------------ |\n| [`Microsoft.Graph`][mggallery]          | [![mg]][mggallery]           | -                              |\n| [`Microsoft.Graph.Beta`][mggallerybeta] | [![mgbeta]][mggallerybeta]   | -                              |\n\nSee [Microsoft Graph PowerShell modules](https://github.com/microsoftgraph/msgraph-sdk-powershell/wiki/MS-Graph-PowerShell-Modules) for a list of all modules supported by this repository.\n\n## Getting Started\n\n### 1. Installation\n\nMicrosoft Graph PowerShell module is published on [PowerShell Gallery](https://www.powershellgallery.com/packages/Microsoft.Graph). Installing is as simple as:\n\n```powershell\nInstall-Module Microsoft.Graph\n```\n\n> Run `Install-Module` with `-AllowClobber` and `-Force` parameters if you run into command name conflicts when upgrading to older versions of the module. This may be the case when upgrading from v1.x to v2.x:\n>\n> ```powershell\n> Install-Module Microsoft.Graph -AllowClobber -Force\n> ```\n\nSee [Install the Microsoft Graph PowerShell Module](https://learn.microsoft.com/powershell/microsoftgraph/installation) guide for detailed installation instructions.\n\n### 2. Authentication\n\nThe module supports two main types of authentication:\n\n#### Delegated access\n\nGet access to Microsoft Graph resources on behalf of a user.\n\n```powershell\n# Using interactive authentication.\nConnect-MgGraph -Scopes \"User.ReadBasic.All\", \"Application.ReadWrite.All\"\n```\n\n#### App-only access (client credentials grant flow)\n\nGet access to Microsoft Graph resources using the identity on an app and not on behalf of a user.\n\n```powershell\n# Using -CertificateThumbprint\nConnect-MgGraph -ClientId \"YOUR_APP_ID\" -TenantId \"YOUR_TENANT_ID\" -CertificateThumbprint \"YOUR_CERT_THUMBPRINT\"\n```\n\nSee [Authentication](./docs/authentication.md) for more information on the usage of `Connect-MgGraph`.\n\n### 3. List users in your tenant\n\n```powershell\nGet-MgUser -Top 10 -Property Id, DisplayName, BusinessPhones | Format-Table Id, DisplayName, BusinessPhones\n```\n\n### 4. Filter a user in your tenant\n\n```powershell\n$User = Get-MgUser -Filter \"displayName eq 'Megan Bowen'\"\n```\n\n### 5. Create a new app registration\n\n```powershell\nNew-MgApplication -DisplayName \"ScriptedGraphPSApp\" `\n                  -SignInAudience \"AzureADMyOrg\" `\n                  -Web @{ RedirectUris = \"https://localhost\"}\n```\n\n### 6. Sign out of the current logged-in context i.e. app only or delegated access\n\n```powershell\nDisconnect-MgGraph\n```\n\n## API Version\n\nInstall `Microsoft.Graph.Beta` module to commands that call Microsoft Graph Beta API endpoint.\n\n```powershell\nInstall-Module Microsoft.Graph.Beta\n# Consume Microsoft Graph beta resources.\nConnect-MgGraph\n$Users = Get-MgBetaUser\n```\n\n## Notes\n\n### Update Schedule\n\nThe Microsoft Graph PowerShell SDK is scheduled to be updated during the fourth week of each month\n\n### Upgrading to v2\n\nThe following breaking changes have been introduced between `v1.x` and `v2.x`:\n\n- Dropped profile support.\n- Dropped support for `-ForceRefresh` on `Connect-MgGraph`.\n- Renamed `beta` command names from `<Verb>-Mg<Noun>` to `<Verb>-MgBeta<Noun>`.\n- Renamed `DeviceManagement.Enrolment` module to `DeviceManagement.Enrollment`.\n- Moved directory role and entitlement management commands from `DeviceManagement.Enrollment` to `Identity.Governance` module.\n- Changed beta namespace from `Microsoft.Graph.PowerShell.Models.<Entity>` to `Microsoft.Graph.Beta.PowerShell.Models.<Entity>`.\n- Changed `-AccessToken` type on `Connect-MgGraph` from `String` to `SecureString`.\n\nSee the [v2 upgrade guide](./docs/upgrade-to-v2.md) for more details.\n\n## Troubleshooting\n\n### Permission Related Errors\n\nWhen working with various operations in the Graph, you may encounter an error such as \"Insufficient privileges to complete the operation.\" For example, this particular error can occur when using the `New-MgApplication` command if the appropriate permissions are not granted.\n\nIf permission-related errors occur and the signed-in user/app has been granted the appropriate permissions to perform the operation, you can explicitly fetch a new access token by running `Disconnect-MgGraph`, then `Connect-MgGraph`. This will trigger a refresh of the access token in your cache. Microsoft Authentication Library (MSAL) will only refresh access tokens in your cache if they have expired (usually an hour).\n\nSee [Microsoft Graph API Permissions Reference](https://learn.microsoft.com/graph/permissions-reference) for more details.\n\n### Common Errors\n\nSee our [troubleshooting guide](https://learn.microsoft.com/powershell/microsoftgraph/troubleshooting) for a detailed view of how to troubleshoot common errors when using Microsoft Graph.\n\n## Known Issues\n\n- Using the `-Property {PropertyName}` parameter will not select the property as the output of the command. All commands return CLR objects, and customers should pipe the command outputs to `Format-Table` or `Select-Object` to return individual properties.\n\n- Customers upgrading from previous versions of the SDK may encounter auth prompts on every command call. If this happens, one can use the following steps to reset their token cache:\n  - Use `Disconnect-MgGraph` to sign out of the current session.\n  - Run `Remove-Item \"$env:USERPROFILE\\.mg\" -Recurse -Force` to delete your token cache.\n  - Run `Connect-MgGraph` to reconstruct a clean token cache.\n\n## Feedback\n\nIf you find any bugs when using the Microsoft Graph PowerShell modules, please file an issue on our GitHub issues page.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/). For more information, see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n\n## License\n\nCopyright (c) Microsoft Corporation. All Rights Reserved. Licensed under the MIT [license](LICENSE.txt).\n\n<!-- References -->\n\n<!-- Shields -->\n\n[mg]: https://img.shields.io/powershellgallery/v/Microsoft.Graph.svg?style=flat-square&label=Microsoft.Graph\n[mgbeta]: https://img.shields.io/powershellgallery/v/Microsoft.Graph.Beta.svg?style=flat-square&label=Microsoft.Graph.Beta\n[mgnext]: https://img.shields.io/powershellgallery/v/Microsoft.Graph.svg?include_prereleases&style=flat-square&label=Microsoft.Graph\n[mgbetanext]: https://img.shields.io/powershellgallery/v/Microsoft.Graph.Beta.svg?include_prereleases&style=flat-square&label=Microsoft.Graph.Beta\n\n<!-- PS Gallery -->\n\n[mggallery]: https://www.powershellgallery.com/packages/Microsoft.Graph/\n[mggallerybeta]: https://www.powershellgallery.com/packages/Microsoft.Graph.Beta/\n",
  "installCommand": "git clone https://github.com/microsoftgraph/msgraph-sdk-powershell ~/.claude/skills/msgraph-sdk-powershell",
  "defaultBranch": "main",
  "hasMarketplaceJson": false,
  "skillPath": "README.md"
}