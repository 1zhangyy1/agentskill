{
  "id": "974eced2654ae4f4",
  "slug": "api-proxy",
  "name": "Api Proxy",
  "description": "a small python container that lets you proxy requests from claude's cloud container through your home network",
  "author": "abra5umente",
  "authorAvatar": "https://avatars.githubusercontent.com/u/87623193?v=4",
  "repoUrl": "https://github.com/abra5umente/api-proxy",
  "repoFullName": "abra5umente/api-proxy",
  "stars": 14,
  "forks": 0,
  "category": "ai-ml",
  "categories": [
    "ai-ml"
  ],
  "tags": [
    "api",
    "claude-ai",
    "claude-skills",
    "llm",
    "proxy-server"
  ],
  "tier": 3,
  "status": "active",
  "createdAt": "2025-12-13T01:21:24Z",
  "updatedAt": "2025-12-19T09:23:14Z",
  "lastCommitAt": "2025-12-13T01:21:27Z",
  "source": "github-topic",
  "collectedAt": "2025-12-26T03:38:30.868Z",
  "authorUrl": "https://github.com/abra5umente",
  "license": "MIT",
  "readme": "# API Proxy for Claude Skills\n\nRoutes API requests through your residential IP for services that block cloud/datacenter IPs (like Reddit, some game APIs, etc).\n\n## Why?\n\nClaude's container runs from cloud infrastructure. Some APIs (notably Reddit) block requests from known cloud IP ranges. This proxy lets Claude's skills route requests through your home network instead.\n\n```\nClaude Container → Your Cloudflare Tunnel → This Proxy → Target API\n     (blocked)                                              (allowed!)\n```\n\n## Quick Start\n\n### 1. Build and deploy\n\n```bash\ndocker build -t your-registry/api-proxy:latest .\ndocker push your-registry/api-proxy:latest\n```\n\n### 2. Add to Docker Compose\n\n```yaml\nservices:\n  api-proxy:\n    image: your-registry/api-proxy:latest\n    container_name: api-proxy\n    restart: unless-stopped\n    environment:\n      - PROXY_AUTH_TOKEN=your-secure-token-here\n      - ALLOWED_DOMAINS=reddit.com,www.reddit.com,oauth.reddit.com\n      - PROXY_TIMEOUT=30\n    networks:\n      - your-network\n```\n\n### 3. Expose via Cloudflare Tunnel\n\nAdd a route in your `config.yml` or Zero Trust dashboard:\n\n```yaml\n- hostname: proxy.yourdomain.com\n  service: http://api-proxy:8000\n```\n\n### 4. Whitelist in Claude\n\nAdd `proxy.yourdomain.com` to your Claude allowed domains in Settings.\n\n## Environment Variables\n\n| Variable | Required | Default | Description |\n|----------|----------|---------|-------------|\n| `PROXY_AUTH_TOKEN` | Yes | `changeme` | Auth token for requests |\n| `ALLOWED_DOMAINS` | No | *(all)* | Comma-separated domain whitelist |\n| `PROXY_TIMEOUT` | No | `30` | Request timeout in seconds |\n\n## API Reference\n\n### `GET /health`\nHealth check endpoint. No authentication required.\n\n```bash\ncurl https://proxy.yourdomain.com/health\n# {\"status\": \"ok\"}\n```\n\n### `POST /proxy`\nProxy a request through residential IP. Requires `X-Proxy-Token` header.\n\n**Request body:**\n```json\n{\n  \"url\": \"https://api.example.com/endpoint\",\n  \"method\": \"GET\",\n  \"headers\": {\"User-Agent\": \"MyBot/1.0\"},\n  \"body\": \"{\\\"optional\\\": \\\"request body\\\"}\"\n}\n```\n\n**Response:**\n```json\n{\n  \"status_code\": 200,\n  \"headers\": {\"content-type\": \"application/json\", ...},\n  \"body\": \"{\\\"response\\\": \\\"from target API\\\"}\"\n}\n```\n\n---\n\n## Claude Skills Integration\n\nThis proxy is designed to work with Claude's [Skills system](https://docs.anthropic.com/). Here's how to integrate it.\n\n### Option 1: Create a Reusable Proxy Helper\n\nCreate a `proxy_helper.py` that your skills can import:\n\n```python\n\"\"\"\nproxy_helper.py - Copy this to your skill's scripts/ folder\n\"\"\"\nimport urllib.request\nimport json\n\nPROXY_URL = \"https://proxy.yourdomain.com/proxy\"\nPROXY_TOKEN = \"your-token-here\"\nDEFAULT_USER_AGENT = \"Claude-Skill/1.0\"\n\ndef proxy_request(url: str, method: str = \"GET\", headers: dict = None, body: str = None) -> dict:\n    \"\"\"Make a request through the residential proxy.\"\"\"\n    req_headers = headers or {}\n    if \"User-Agent\" not in req_headers:\n        req_headers[\"User-Agent\"] = DEFAULT_USER_AGENT\n    \n    payload = {\"url\": url, \"method\": method, \"headers\": req_headers}\n    if body:\n        payload[\"body\"] = body\n    \n    req = urllib.request.Request(\n        PROXY_URL,\n        data=json.dumps(payload).encode(),\n        headers={\n            \"Content-Type\": \"application/json\",\n            \"X-Proxy-Token\": PROXY_TOKEN\n        }\n    )\n    \n    try:\n        response = urllib.request.urlopen(req, timeout=30)\n        result = json.loads(response.read().decode())\n        \n        if result[\"status_code\"] >= 400:\n            return {\"error\": f\"Target returned {result['status_code']}\"}\n        \n        return json.loads(result[\"body\"])\n    except Exception as e:\n        return {\"error\": str(e)}\n\ndef proxy_get(url: str, headers: dict = None) -> dict:\n    \"\"\"Convenience wrapper for GET requests.\"\"\"\n    return proxy_request(url, method=\"GET\", headers=headers)\n\ndef proxy_post(url: str, body: str, headers: dict = None) -> dict:\n    \"\"\"Convenience wrapper for POST requests.\"\"\"\n    return proxy_request(url, method=\"POST\", headers=headers, body=body)\n```\n\n### Option 2: Create an api-proxy Skill\n\nBundle the helper as a standalone skill that other skills can reference:\n\n```\napi-proxy/\n├── SKILL.md\n└── scripts/\n    └── proxy_helper.py\n```\n\n**SKILL.md:**\n```markdown\n---\nname: api-proxy\ndescription: Routes API requests through residential proxy for APIs that block cloud IPs.\n---\n\n# API Proxy Skill\n\nCopy `scripts/proxy_helper.py` to your skill's scripts folder, then:\n\n\\`\\`\\`python\nimport sys, os\nsys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))\nfrom proxy_helper import proxy_get\n\ndata = proxy_get(\"https://www.reddit.com/r/homelab.json\")\n\\`\\`\\`\n```\n\n### Using in Your Skills\n\nOnce you have the proxy helper, use it in your skill scripts:\n\n```python\n#!/usr/bin/env python3\n\"\"\"browse_subreddit.py - Example skill script\"\"\"\nimport sys\nimport os\nimport json\n\n# Import the proxy helper\nsys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))\nfrom proxy_helper import proxy_get\n\ndef browse_subreddit(subreddit: str, limit: int = 10) -> dict:\n    url = f\"https://www.reddit.com/r/{subreddit}/hot.json?limit={limit}\"\n    return proxy_get(url)\n\nif __name__ == \"__main__\":\n    subreddit = sys.argv[1] if len(sys.argv) > 1 else \"homelab\"\n    result = browse_subreddit(subreddit)\n    print(json.dumps(result, indent=2))\n```\n\n### Skill Structure Example\n\nA complete Reddit skill using the proxy:\n\n```\nreddit/\n├── SKILL.md\n└── scripts/\n    ├── proxy_helper.py      # Copied from api-proxy skill\n    ├── browse_subreddit.py\n    ├── search_reddit.py\n    └── get_post_details.py\n```\n\n---\n\n## Security\n\n- **Auth token**: Required for all `/proxy` requests. Generate with `python3 -c \"import secrets; print(secrets.token_urlsafe(32))\"`\n- **Domain whitelist**: Restrict which APIs can be proxied\n- **No direct exposure**: Only accessible via Cloudflare Tunnel\n- **No host port binding**: Container doesn't expose ports to host network\n\n### Token Storage\n\nYour token lives in:\n1. Container environment variables (not publicly visible)\n2. Your skill files (in Claude's private `/mnt/skills/user/` directory)\n\n**Don't commit tokens to public repos!** Use `.gitignore` or environment variable substitution.\n\n## Troubleshooting\n\n| Error | Cause | Fix |\n|-------|-------|-----|\n| 401 from proxy | Invalid token | Check `X-Proxy-Token` matches `PROXY_AUTH_TOKEN` |\n| 403 from proxy | Domain not whitelisted | Add domain to `ALLOWED_DOMAINS` |\n| 503 from proxy | Rate limited / upstream error | Retry after delay |\n| 504 from proxy | Timeout | Increase `PROXY_TIMEOUT` |\n| Connection refused | Proxy not running | Check container status and CF tunnel |\n\n## License\n\nMIT\n",
  "installCommand": "git clone https://github.com/abra5umente/api-proxy ~/.claude/skills/api-proxy",
  "defaultBranch": "main",
  "hasMarketplaceJson": false,
  "skillPath": "README.md"
}